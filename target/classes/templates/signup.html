<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Sign Up</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<div class="form-box" >
  <form id="signup-form">
    <h2>Sign Up</h2>
      <input type="text" id="username" name="username" placeholder="Username" required>
      <input type="email" id="email" name="email" placeholder="Email" required>
      <input type="password" id="password" name="password" placeholder="Password" required>
      <input type="password" id="passwordcon" name="passwordcon" placeholder="Confirm Password" required>
      <button type="submit" id="submit" name="signup">Sign up</button>
      <p>Already have an account? <a href="/req/login">Login</a></p>
  </form>
</div>

</body>

<script>
  document.getElementById("signup-form").addEventListener('submit', function(e) {
    e.preventDefault();

    const login = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('passwordcon').value;
    const email = document.getElementById('email').value;

    if (password !== confirmPassword) {
      alert("Passwords do not match");
      return;
    }

    const data = {
      login: login,
      email: email,
      password: password
    };

    fetch('/req/signup', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          alert('Registration successful!');
          window.location.href = '/req/login';
        } else {
          alert('Registration successful!');
          window.location.href = '/req/login';
        }
      })
      .catch(error => {
        alert('Registration successful!');
        window.location.href = '/req/login';

      });
  });

</script>
</html>